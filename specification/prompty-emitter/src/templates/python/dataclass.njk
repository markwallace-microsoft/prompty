{%- set comma = joiner() -%}
##########################################
# WARNING: This is an auto-generated file.
# DO NOT EDIT THIS FILE DIRECTLY
# ANY EDITS WILL BE LOST
##########################################

{%- if typingIncludes and typingIncludes.length > 0 %}
from typing import{% for item in typingIncludes -%}{{ comma() }} {{ item }}{% endfor %}
{%- endif %}
from dataclasses import dataclass, field
{%- for import in imports %}
{{ import }}
{%- endfor %}


@dataclass
class {{ node.typeName }}{%- if node.baseType.length > 0 -%}({{ node.baseType }}){%- endif -%}:
    """{%- for line in node.description.split('\n') -%}
    {{ line }}
    {% endfor -%}
    {% if node.properties.length > 0 %}
    Attributes
    ----------
    {% for prop in node.properties -%}
    {{ prop.name }} : {{ renderType(node, prop) | safe }}
        {{ prop.description }}
    {% endfor %}
    """ 
    {% for prop in node.properties -%}
    {{ prop.name }}: {{ renderType(node, prop) | safe }}{{ renderDefault(node, prop) | safe }}
    {% endfor %}

    def load(self, data: Optional[dict] = None):
        {% for prop in node.properties -%}
        if data is not None and "{{ prop.name }}" in data:
            self.{{ prop.name }} = {% if prop.kind == "Scalar" %}data["{{ prop.name }}"]{% else %}self.load_{{ prop.name }}(data["{{ prop.name }}"]){% endif %}
        {% endfor -%}

    {% for prop in node.properties | selectattr("isCollection") %}
    def load_{{ prop.name }}(self, data: Optional[dict] = None) -> list[{{ prop.typeName }}]:
        if data is not None and "{{ prop.name }}" in data:
            return [{{ prop.typeName | safe }}(item) for item in data["{{ prop.name }}"]]
        else:
            return []
    {% endfor %}
    {% else %}
    """

    def __init__(self, data: Optional[dict] = None):
        if data is None:
            data = {}
        else:
            self.data = data
    
    # Fallback for unknown properties
    data: dict = field(default_factory=dict)

    def __getitem__(self, key):
        return self.data[key]

    def __setitem__(self, key, value):
        self.data[key] = value

    def __delitem__(self, key):
        del self.data[key]

    def __contains__(self, key):
        return key in self.data

    def keys(self):
        return self.data.keys()

    def values(self):
        return self.data.values()

    def items(self):
        return self.data.items()

    def __repr__(self):
        return repr(self.data)
    {% endif %}